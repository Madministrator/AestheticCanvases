<!DOCTYPE html>
<html>
    <head>
        <title>Aesthetic Canvases</title>
    </head>
    <body>
        <canvas id="clock" width="600" height="600" style="background-color: #333;"></canvas>

        <!--Reminder that adding the script tags at the bottom makes
            sure that the page has loaded before the code runs-->
        <script>
            // inspired by: https://www.w3schools.com/graphics/canvas_clock.asp

            let canvas = document.getElementById('clock')
            let ctx = canvas.getContext('2d')
            // prevent dimension mismatch, use the shortest dimension to determine the radius
            let radius = canvas.height <= canvas.width ? canvas.height / 2 : canvas.width / 2
            ctx.translate(radius, radius) // center the origin (0,0) in the center of the canvas
            
            // setInterval(drawClock(ctx, radius), 1000)
            setInterval(function(){ drawClock(ctx, radius) }, 1000)

            /**
                Draws a clock once
                @param ctx {CanvasRenderingContext2D} the canvas context
                @param r {Number} the radius of the canvas element
            */
            function drawClock(ctx, r) {
                // note: order of operations matters as we draw
                // sequentially from back to front.
                let radius = r * 0.95
                drawFace(ctx, radius)
                drawNumbers(ctx, radius)
                drawTime(ctx, radius)
            }

            /**
                Draws the face of the clock.
                @param ctx {CanvasRenderingContext2D} the canvas context
                @param r {Number} the radius of the clock face
            */
            function drawFace(ctx, r) {
                // white circle base
                ctx.arc(0, 0, radius * 0.95, 0, 2 * Math.PI)
                ctx.fillStyle = 'white'
                ctx.fill()
                // graident to create rounded edge look
                let gradient = ctx.createRadialGradient(0, 0, r * 0.95, 0, 0, r * 1.02)
                gradient.addColorStop(0, '#333')
                gradient.addColorStop(0.5, 'white')
                gradient.addColorStop(1, '#333')
                ctx.strokeStyle = gradient
                ctx.lineWidth = r * 0.1
                ctx.stroke()
                // draw dot in the center of the clock
                ctx.beginPath()
                ctx.arc(0, 0, r * 0.1, 0, 2 * Math.PI)
                ctx.fillStyle = '#333'
                ctx.fill()
            }

            /*
                Draws the numbers over the face of the clock.
                @param ctx {CanvasRenderingContext2D} the canvas context
                @param r {Number} the radius of the clock face
            */
            function drawNumbers(ctx, r) {
                // I could play with font here
                ctx.font = radius * 0.15 + "px arial"
                ctx.textBaseline = "middle"
                ctx.textAlign = "center"
                for(let num = 1; num < 13; num++) {
                    let theta = (num * Math.PI / 6) - Math.PI / 2
                    let x = r * Math.cos(theta) * 0.85
                    let y = r * Math.sin(theta) * 0.85
                    ctx.fillText(num.toString(), x, y)
                }
            }

            /**
                Draws the minute and hour hands on the clock.
                @param ctx {CanvasRenderingContext2D} the canvas context
                @param r {Number} the radius of the clock face
            */
            function drawTime(ctx, r) {
                let now = new Date()
                let hour = now.getHours()
                let minute = now.getMinutes()
                let second = now.getSeconds()
                // hour
                hour = hour % 12
                hour =  (hour * Math.PI / 6 ) + (minute * Math.PI / (6 * 60)) 
                        + (second * Math.PI / (360 * 60))
                drawHand(ctx, hour, radius * 0.5, radius * 0.07)
                //minute
                minute = (minute * Math.PI / 30) + (second * Math.PI / (30 * 60))
                drawHand(ctx, minute, radius * 0.75, radius * 0.07)
                // second
                second = (second*Math.PI/30)
                drawHand(ctx, second, radius * 0.85, radius * 0.02)
            }

            /**
                Draws a single hand on the clock
                @param ctx {CanvasRenderingContext2D} the canvas context
                @param pos (Number) the angle in radians the hand should point to
                @param length the length of the line of the hand
                @param width the width of the line of the hand
            */
            function drawHand(ctx, pos, length, width) {
                // determine where the line is drawn
                let theta = (pos * Math.PI / 6) - Math.PI / 2
                let x = length * Math.cos(theta)
                let y = length * Math.sin(theta)
                // set drawing behavior
                ctx.lineCap = 'round'
                ctx.lineWidth = width
                // draw the line
                ctx.beginPath()
                ctx.moveTo(0,0)
                ctx.lineTo(x, y)
                ctx.stroke()
                ctx.beginPath()
            }
        </script>
    </body>
</html>